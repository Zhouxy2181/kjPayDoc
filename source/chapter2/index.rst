接入指南
===========
立收产品采用了 HTTPS 协议提供各类接口，并且所有接口都是统一请求地址，方便合作机构简单、快速接入。


接口说明
----------
列举了常用接口，可根据实际业务需要增删其中的接口，自由组合。详细请看左侧分类菜单中的接口名称和详细介绍。

会员管理
~~~~~~~~~

+----+-----------------------+-----------------------------------------------------------+
|序号|   会员管理接口调用顺序|      备注说明                                             |
+----+-----------------------+-----------------------------------------------------------+
| 1  |   U1003会员资料上传_  |   上传会员影像信息得到文件ID备用                          |
+----+-----------------------+-----------------------------------------------------------+
| 2  |   U1011会员注册_      |   注册得到userId备用（注：该接口需上送U1003返回文件ID）   |
+----+-----------------------+-----------------------------------------------------------+
| 3  |   U1001发送短信验证_  |   返回验证码备用                                          |
+----+-----------------------+-----------------------------------------------------------+
| 4  |   U1002短信验证码验证_|   校验U1001发送验证码（注：需上送U1001请求流水号）        |
+----+-----------------------+-----------------------------------------------------------+
| 5  |   U1012会员注册确认_  |   需上送U1011请求流水号与userId以及U1001验证码            |                  
+----+-----------------------+-----------------------------------------------------------+

.. _U1003会员资料上传: ../user/index.html#u1003
.. _U1011会员注册: ../user/index.html#u1011
.. _U1001发送短信验证: ../user/index.html#u1001
.. _U1002短信验证码验证: ../user/index.html#u1002
.. _U1012会员注册确认: ../user/index.html#u1012

快捷支付
~~~~~~~~

+----+-----------------------+------------------------------------------------------------+
|序号|  快捷支付接口调用顺序 |     备注说明                                               |
+----+-----------------------+------------------------------------------------------------+
| 1  |  S2001快捷签约_       |   有页面，返回H5链接（注：需上送userId）                   |
+----+-----------------------+------------------------------------------------------------+
| 2  |  N2004签约页面_       |   需上送S2001签约请求流水号                                |
+----+-----------------------+------------------------------------------------------------+
| 3  |  P2005创建订单_       |   返回签约流水号备用（注：需上送userId）                   |
+----+-----------------------+------------------------------------------------------------+
| 4  |  P2006支付确认_       |   有短信验证码（注：需上送P2005返回订单流水号和交易流水号）|
+----+-----------------------+------------------------------------------------------------+

.. _S2001快捷签约: ../kjpay/index.html#s2001
.. _N2004签约页面: ../kjpay/index.html#n2004
.. _P2005创建订单: ../kjpay/index.html#p2005
.. _P2006支付确认: ../kjpay/index/html#p2006


通讯方式
--------
- 采用 HTTPS 协议，报文提交方式为POST，采用Key=Value格式。

- 接口的请求和返回均需要签名与验证。

- 前台跳转类为GET 参数机制回传给合作机构。


编码格式
--------

UTF-8


加密方式
----------

业务字段加密
~~~~~~~~~~~~

- 业务数据_ 对应字段JSON序列化以后，AES加密BASE64处理后存入报文的bizData字段。

.. _业务数据: ../chapter3/index.html#id7

报文签名与验签
~~~~~~~~~~~~~~~
- 通信请求字段_ 中出现签名域（signature之外）所有非空值数据元采用key=value的形式按照名称的ASCII码从小到大进行排序，如果名称首字母相同，则比较第二个字母，以此类推，然后以&作为拼接符拼接成待签名串，对待签名串使用SHA256WithRSA方式计算签名，签名结果BASE64编码后，存入到 signature字段。

- 通信响应字段_ 中出现签名域（signature之外）所有字段采用Key=Value的形式按照名称排序，然后以&作为拼接符拼接成待签名串，对待签名串使用SHA-256算法做摘要，再使用入网时立收平台提供的验签公钥对摘要和报文中的签名信息做签名验证操作。

.. _通信请求字段: ../chapter3/index.html#id5
.. _通信响应字段: ../chapter3/index.html#id6
